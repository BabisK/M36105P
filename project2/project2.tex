%%This is a very basic article template.
%%There is just one section and two subsections.
\documentclass[a4paper]{article}

\usepackage{a4wide}
\usepackage{amsmath}
\usepackage{ltxtable}

\begin{document}

\title{Numerical Optimization\\Project 2}
\author{Charalampos Kaidos}

\maketitle

\section{}

The equations to be solved are:
\begin{align}
f_1 = (x - A_1)^2 + (y - B_1)^2 + (z - C_1)^2 - [c(t1 - d)]^2 =0 \nonumber\\
f_2 = (x - A_2)^2 + (y - B_2)^2 + (z - C_2)^2 - [c(t2 - d)]^2 =0 \nonumber\\
f_3 = (x - A_3)^2 + (y - B_3)^2 + (z - C_3)^2 - [c(t3 - d)]^2 =0 \nonumber\\
f_4 = (x - A_4)^2 + (y - B_4)^2 + (z - C_4)^2 - [c(t4 - d)]^2 =0 \nonumber
\end{align}

We will use the Newton method with initial values:
$$
u_0 = [x_0, y_0, z_0, d_0] = [0, 0, 6370, 0]
$$

Given that we can calculate the Jacobian matrix of $F(u)=[f_1, f_2,f_3, f_4]$:
$$
J(u) =
\begin{bmatrix}
	\frac{\partial{f_1}}{\partial{x}} & \frac{\partial{f_1}}{\partial{y}} &
	\frac{\partial{f_1}}{\partial{z}} & \frac{\partial{f_1}}{\partial{d}} \\
	\frac{\partial{f_2}}{\partial{x}} & \frac{\partial{f_2}}{\partial{y}} &
	\frac{\partial{f_2}}{\partial{z}} & \frac{\partial{f_2}}{\partial{d}} \\
	\frac{\partial{f_3}}{\partial{x}} & \frac{\partial{f_3}}{\partial{y}} &
	\frac{\partial{f_3}}{\partial{z}} & \frac{\partial{f_3}}{\partial{d}} \\
	\frac{\partial{f_4}}{\partial{x}} & \frac{\partial{f_4}}{\partial{y}} &
	\frac{\partial{f_4}}{\partial{z}} & \frac{\partial{f_4}}{\partial{d}} \\
\end{bmatrix}
=
\begin{bmatrix}
	2(x-A_1) & 2(y-B_1) & 2(z-C_1) & 2c^2(t_1-d) \\
	2(x-A_2) & 2(y-B_2) & 2(z-C_2) & 2c^2(t_2-d) \\
	2(x-A_3) & 2(y-B_3) & 2(z-C_3) & 2c^2(t_3-d) \\
	2(x-A_4) & 2(y-B_4) & 2(z-C_4) & 2c^2(t_4-d) \\
\end{bmatrix}
$$

And the correction for each iteration:
$$
J(u)S(u)=-F(u)
$$

Finally, starting with $u_0$ we aproximate $u_k$ for $k=1,2,\dots$:
$$
u_k = u_{k-1} + s
$$

The results:

\begin{center}
	\begin{tabular}{r | c }
		& Solution 1 \\ \hline
		x & -4.17727096e+01\\ \hline
		y & -1.67891941e+01\\ \hline
		z & 6.37005956e+03\\ \hline
		height & 0.218648080791354\\ \hline
		d & -3.20156583e-03
	\end{tabular} 
\end{center}

The file 1\_multivarite\_newton.py contains the implementation of the above

\section{}

We will subtract the first equation $f_1$ from the last three $f_2, f_3, f_4$:
\begin{align}
f_2 - f_1 = 0 \Leftrightarrow \nonumber\\
(x - A_2)^2 - (x - A_1)^2 + (y - B_2)^2 - (y - B_1)^2 + (z - C_2)^2 - (z - C_1)^2 - [c(t_2 - d)]^2 + [c(t_1 - d)]^2 = 0 \Leftrightarrow \nonumber\\
2(A_1 - A_2)x + 2(B_1 - B_2)y + 2(C_1 - C_2)z + 2c^2(t_2 - t_1)d + A_2^2 - A_1^2 + B_2^2 - B_1^2 + C_2^2 - C_1^2 + c^2t_1^2 - c^2t_2^2 = 0 \nonumber\\
\nonumber\\
f_3 - f_1 = 0 \Leftrightarrow \nonumber\\
(x - A_3)^2 - (x - A_1)^2 + (y - B_3)^2 - (y - B_1)^2 + (z - C_3)^2 - (z - C_1)^2 - [c(t_3 - d)]^2 + [c(t_1 - d)]^2 = 0 \Leftrightarrow \nonumber\\
2(A_1 - A_3)x + 2(B_1 - B_3)y + 2(C_1 - C_3)z + 2c^2(t_3 - t_1)d + A_3^2 - A_1^2 + B_3^2 - B_1^2 + C_3^2 - C_1^2 + c^2t_1^2 - c^2t_3^2 = 0 \nonumber\\
\nonumber\\
f_4 - f_1 = 0 \Leftrightarrow \nonumber\\
(x - A_4)^2 - (x - A_1)^2 + (y - B_4)^2 - (y - B_1)^2 + (z - C_4)^2 - (z - C_1)^2 - [c(t4 - d)]^2 + [c(t1 - d)]^2 = 0 \Leftrightarrow \nonumber\\
2(A_1 - A_4)x + 2(B_1 - B_4)y + 2(C_1 - C_4)z + 2c^2(t_4 - t_1)d + A_4^2 - A_1^2 + B_4^2 - B_1^2 + C_4^2 - C_1^2 + c^2t_1^2 - c^2t_4^2 = 0 \nonumber\\
\nonumber
\end{align}

From the above we define the column vectors $\vec{u}_x$, $\vec{u}_y$, $\vec{u}_z$, $\vec{u}_d$ and $\vec{w}$:
\begin{align}
\vec{u}_x &= \begin{bmatrix}
2(A_1 - A_2)\\
2(A_1 - A_3)\\
2(A_1 - A_4)\\
\end{bmatrix}\nonumber\\
\vec{u}_y &= \begin{bmatrix}
2(B_1 - B_2)\\
2(B_1 - B_3)\\
2(B_1 - B_4)\\
\end{bmatrix}\nonumber\\
\vec{u}_z &= \begin{bmatrix}
2(C_1 - C_2)\\
2(C_1 - C_3)\\
2(C_1 - C_4)\\
\end{bmatrix}\nonumber\\
\vec{u}_d &= \begin{bmatrix}
2c^2(t_2 - t_1)\\
2c^2(t_3 - t_1)\\
2c^2(t_4 - t_1)\\
\end{bmatrix}\nonumber\\
\vec{w} &= \begin{bmatrix}
A_2^2 - A_1^2 + B_2^2 - B_1^2 + C_2^2 - C_1^2 + c^2t_1^2 - c^2t_2^2\\
A_3^2 - A_1^2 + B_3^2 - B_1^2 + C_3^2 - C_1^2 + c^2t_1^2 - c^2t_3^2\\
A_4^2 - A_1^2 + B_4^2 - B_1^2 + C_4^2 - C_1^2 + c^2t_1^2 - c^2t_4^2\\
\end{bmatrix}\nonumber\\
\end{align}

Thus:

$$
x\vec{u}_x + y\vec{u}_y + z\vec{u}_z + d\vec{u}_d + \vec{w} = 0
$$

The determinant is $0$ when the columns are not linearly independent. Also the determinant is linear operator and we can move variables in and out of the function. We will construct equations using this property of the determinant.

\begin{align}
\det[\vec{u}_y | \vec{u}_z | x \vec{u}_x + y \vec{u}_y + z \vec{u}_z + d \vec{u}_d + \vec{w}] = 0 \Leftrightarrow \nonumber\\
\det[\vec{u}_y | \vec{u}_z | x \vec{u}_x] + \det[\vec{u}_y | \vec{u}_z | y \vec{u}_y] + \det[\vec{u}_y | \vec{u}_z | z \vec{u}_z] + \det[\vec{u}_y | \vec{u}_z | d \vec{u}_d] + \det[\vec{u}_y | \vec{u}_z | \vec{w}] = 0 \Leftrightarrow \nonumber \\
x\det[\vec{u}_y | \vec{u}_z | \vec{u}_x] + d\det[\vec{u}_y | \vec{u}_z | \vec{u}_d] + \det[\vec{u}_y | \vec{u}_z | \vec{w}] = 0 \Leftrightarrow \nonumber \\
\frac{d\det[\vec{u}_y | \vec{u}_z | \vec{u}_d] + \det[\vec{u}_y | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} = x \nonumber 
\end{align}

We caclulate $y$ and $z$ using the same function:
\begin{align}
\frac{d\det[\vec{u}_x | \vec{u}_z | \vec{u}_d] + \det[\vec{u}_x | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} = y \nonumber \\
\frac{d\det[\vec{u}_y | \vec{u}_x | \vec{u}_d] + \det[\vec{u}_y | \vec{u}_x | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} = z \nonumber 
\end{align}

We replace $x$, $y$ and $z$ into $f_1$:
\begin{align}
f_1 &= (\frac{d\det[\vec{u}_y | \vec{u}_z | \vec{u}_d] + \det[\vec{u}_y | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - A_1)^2 + (\frac{d\det[\vec{u}_x | \vec{u}_z | \vec{u}_d] + \det[\vec{u}_x | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - B_1)^2 + \nonumber \\
&+ (\frac{d\det[\vec{u}_y | \vec{u}_x | \vec{u}_d] + \det[\vec{u}_y | \vec{u}_x | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - C_1)^2 - [c(t_1 - d)]^2 = \nonumber \\
&= d^2(\frac{\det[\vec{u}_y | \vec{u}_z | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]})^2 + 2d\frac{\det[\vec{u}_y | \vec{u}_z | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]}(\frac{\det[\vec{u}_y | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - A_1) + (\frac{\det[\vec{u}_y | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - A_1)^2 + \nonumber\\
&+ d^2(\frac{\det[\vec{u}_x | \vec{u}_z | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]})^2 + 2d\frac{\det[\vec{u}_x | \vec{u}_z | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]}(\frac{\det[\vec{u}_x | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - B_1) + (\frac{\det[\vec{u}_x | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - B_1)^2 + \nonumber\\
&+ d^2(\frac{\det[\vec{u}_y | \vec{u}_x | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]})^2 + 2d\frac{\det[\vec{u}_y | \vec{u}_x | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]}(\frac{\det[\vec{u}_y | \vec{u}_x | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - C_1) + (\frac{\det[\vec{u}_y | \vec{u}_x | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - C_1)^2 + \nonumber\\
&- c^2t_1^2 + 2c^2t_1d - c^2d^2) = 0 \nonumber
\end{align}

Thus:

\begin{align}
\alpha &= (\frac{\det[\vec{u}_y | \vec{u}_z | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]})^2 + (\frac{\det[\vec{u}_x | \vec{u}_z | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]})^2 + (\frac{\det[\vec{u}_y | \vec{u}_x | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]})^2 - c^2 \nonumber \\
\beta &= 2\frac{\det[\vec{u}_y | \vec{u}_z | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]}(\frac{\det[\vec{u}_y | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - A_1) + 2\frac{\det[\vec{u}_x | \vec{u}_z | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]}(\frac{\det[\vec{u}_x | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - B_1) \nonumber\\
&+ 2\frac{\det[\vec{u}_y | \vec{u}_x | \vec{u}_d]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]}(\frac{\det[\vec{u}_y | \vec{u}_x | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - C_1) + 2c^2t_1 \nonumber\\
\gamma &= (\frac{\det[\vec{u}_y | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - A_1)^2 + (\frac{\det[\vec{u}_x | \vec{u}_z | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - B_1)^2 + (\frac{\det[\vec{u}_y | \vec{u}_x | \vec{w}]}{\det[\vec{u}_y | \vec{u}_z | \vec{u}_x]} - C_1)^2 + c^2t_1^2 \nonumber
\end{align}

From there we compute the roots and get $2$ values for $d$:
\begin{align}
d_1 = \frac{-\beta - \sqrt{\beta^2 - 4\alpha\gamma}}{2\alpha}\nonumber\\
d_2 = \frac{-\beta + \sqrt{\beta^2 - 4\alpha\gamma}}{2\alpha}\nonumber
\end{align}

We replace these values back to the functions to caclulate $x$, $y$ and $z$. The results we get are:
\begin{center}
\begin{tabular}{r | c | c}
	& Solution 1 & Solution 2\\ \hline
	x & -4.17727096e+01 & -3.97478373e+01\\ \hline
	y & -1.67891941e+01 & -1.34274144e+02\\ \hline
	z & 6.37005956e+03 & -9.41362455e+03\\ \hline
	d & -3.20156583e-03 & 1.85173047e-01\\ \hline
	height & 2.18648081e-01 & 3.04466604e+03
\end{tabular} 
\end{center}

\section{}
\section{}

We selected $\phi_i \in [0, \frac{\pi}{6}, \frac{\pi}{3}, \frac{\pi}{2}]$ and $\theta_i \in [0, \frac{\pi}{2}, \pi, \frac{3\pi}{2}]$. With this we calculated the positions and timings of the satellites. We fed the positions of the satelites to the multivariate newton algorithm and got results very close to the actual location:
\begin{center}
	\begin{tabular}{r | c}
		& True data\\ \hline
		x & -5.7589605295040847e-12\\ \hline
		y & -2.0617434301369693e-12\\ \hline
		z & 6369.9999999999973\\ \hline
	\end{tabular}
\end{center}

Then, we modified the timings of the satellites by $10^-8$ and fed the new satellite data to the algorithm. With the data we got back we calculated the distance from the correct position and the EMF:
\begin{center}
	\begin{longtable}{@{}c|@{}c|@{}c|@{}c|@{}c|@{}c|@{}cX@{}}
		$\Delta t_1$ & $\Delta t_2$ & $\Delta t_3$ & $\Delta t_4$ & $\| \Delta x, \Delta y, \Delta z \|_{\inf}$ & EMF & distance\\ \hline
		-1e-08 & -1e-08 & -1e-08 & -1e-08 & 2.154748779767829e-12 & 7.187468274808947e-10 & 2.959661067074264e-12\\ \hline
		-1e-08 & -1e-08 & -1e-08 & 0.0 & 0.004874184860454989 & 1.6258530636619768 & 0.005796515540262854\\ \hline
		-1e-08 & -1e-08 & -1e-08 & 1e-08 & 0.009748371031491843 & 3.251706564487008 & 0.011593032748796837\\ \hline
		-1e-08 & -1e-08 & 0.0 & -1e-08 & 0.003765156364564801 & 1.2559209766866828 & 0.0052790105199515425\\ \hline
		-1e-08 & -1e-08 & 0.0 & 0.0 & 0.001905007902678335 & 0.635442237736697 & 0.002647811697583805\\ \hline
		-1e-08 & -1e-08 & 0.0 & 1e-08 & 0.006779193330658018 & 2.261295490704535 & 0.007304316800875232\\ \hline
		-1e-08 & -1e-08 & 1e-08 & -1e-08 & 0.007530312210697209& 2.5118417804429334& 0.010558020426243134\\ \hline
		-1e-08 & -1e-08 & 1e-08 & 0.0& 0.004432329078232547& 1.478465839379298& 0.006013163969198772\\ \hline
		-1e-08 & -1e-08 & 1e-08 & 1e-08 & 0.003810015833551006& 1.2708844848780119& 0.005295623458340998\\ \hline
		-1e-08 & 0.0 & -1e-08 & -1e-08 & 0.0031303716313940398& 1.044179581409526& 0.00313037163139404\\ \hline
		-1e-08 & 0.0 & -1e-08 & 0.0& 0.004874184793152381& 1.6258530412122432& 0.006818648388013358\\ \hline
		-1e-08 & 0.0 & -1e-08 & 1e-08 & 0.009748370943270857& 3.2517065350596543& 0.012263275650696254\\ \hline
		-1e-08 & 0.0 & 0.0 & -1e-08 & 0.0037651563621598073& 1.2559209758844634& 0.0048829358085042684\\ \hline
		-1e-08 & 0.0 & 0.0 & 0.0& 0.0019050079081353033& 0.6354422395569456& 0.0024660010796648054\\ \hline
		-1e-08 & 0.0 & 0.0 & 1e-08 & 0.006779193320653576& 2.2612954873674123& 0.007451070006669363\\ \hline
		-1e-08 & 0.0 & 1e-08 & -1e-08 & 0.007530312207842004& 2.5118417794905397& 0.00967588721226891\\ \hline
		-1e-08 & 0.0 & 1e-08 & 0.0& 0.004432329075872289& 1.4784658385920009& 0.00462647609952944\\ \hline
		-1e-08 & 0.0 & 1e-08 & 1e-08 & 0.003810015897215635& 1.2708845061142464& 0.004047827982226529\\ \hline
		-1e-08 & 1e-08 & -1e-08 & -1e-08 & 0.006260743663389717& 2.088359296445375& 0.006260743663389721\\ \hline
		-1e-08 & 1e-08 & -1e-08 & 0.0& 0.006755117678579856& 2.25326471759855& 0.008887451809389218\\ \hline
		-1e-08 & 1e-08 & -1e-08 & 1e-08 & 0.009748370753186464& 3.251706471654326& 0.01363729863430391\\ \hline
		-1e-08 & 1e-08 & 0.0 & -1e-08 & 0.004052679873799191& 1.351828495943131& 0.006278266027180499\\ \hline
		-1e-08 & 1e-08 & 0.0 & 0.0& 0.004547053615074925& 1.5167338257282954& 0.004974924161166646\\ \hline
		-1e-08 & 1e-08 & 0.0 & 1e-08 & 0.00677919320150977& 2.2612954476253164& 0.008791035285343621\\ \hline
		-1e-08 & 1e-08 & 1e-08 & -1e-08 & 0.0075303122066029205& 2.511841779077226& 0.009765871054634582\\ \hline
		-1e-08 & 1e-08 & 1e-08 & 0.0& 0.004432329075128091& 1.478465838343763& 0.005123365086907778\\ \hline
		-1e-08 & 1e-08 & 1e-08 & 1e-08 & 0.0038100158508314053& 1.2708844906421328& 0.004932002220536387\\ \hline
		0.0 & -1e-08 & -1e-08 & -1e-08 & 0.001905007881759957& 0.635442230759077& 0.0024660010307562636\\ \hline
		0.0 & -1e-08 & -1e-08 & 0.0& 0.0037651568746934583& 1.2559211468472868& 0.004882936369881724\\ \hline
		0.0 & -1e-08 & -1e-08 & 1e-08 & 0.007843362060157233& 2.6162639702849475& 0.010430924193834611\\ \hline
		0.0 & -1e-08 & 0.0 & -1e-08 & 0.004874183628089668& 1.6258526525891532& 0.006818646531567671\\ \hline
		0.0 & -1e-08 & 0.0 & 0.0& 0.003130371243547221& 1.0441794520377528& 0.0031303712435472213\\ \hline
		0.0 & -1e-08 & 0.0 & 1e-08 & 0.004874184824984695& 1.6258530518303604& 0.006348517315616135\\ \hline
		0.0 & -1e-08 & 1e-08 & -1e-08 & 0.00784335915614065& 2.616263001609283& 0.01194330763898946\\ \hline
		0.0 & -1e-08 & 1e-08 & 0.0& 0.005338433871955931& 1.7807098652114348& 0.007175742945285869\\ \hline
		0.0 & -1e-08 & 1e-08 & 1e-08 & 0.004844060856624737& 1.6158047775753042& 0.005247770894134703\\ \hline
		0.0 & 0.0 & -1e-08 & -1e-08 & 0.0019050078872169252& 0.6354422325793257& 0.0026478116400407547\\ \hline
		0.0 & 0.0 & -1e-08 & 0.0& 0.0037651568740463223& 1.2559211466314255& 0.0052790111279209856\\ \hline
		0.0 & 0.0 & -1e-08 & 1e-08 & 0.007843362020139466& 2.616263956936457& 0.010766810910874546\\ \hline
		0.0 & 0.0 & 0.0 & -1e-08 & 0.00487418356078706& 1.6258526301394198& 0.005796513887815021\\ \hline
		0.0 & 0.0 & 0.0 & 1e-08 & 0.004874184861364483& 1.6258530639653515& 0.005796515543268541\\ \hline
		0.0 & 0.0 & 1e-08 & -1e-08 & 0.007843359014259477& 2.6162629542828175& 0.01076680648671007\\ \hline
		0.0 & 0.0 & 1e-08 & 0.0& 0.00376515636522775& 1.2559209769078188& 0.005279010525124297\\ \hline
		0.0 & 0.0 & 1e-08 & 1e-08 & 0.001905007902678335& 0.635442237736697& 0.0026478116967310985\\ \hline
		0.0 & 1e-08 & -1e-08 & -1e-08 & 0.004844061474319292& 1.6158049836160298& 0.0052477715343734474\\ \hline
		0.0 & 1e-08 & -1e-08 & 0.0& 0.005338435347318415& 1.7807103573393872& 0.007175744283335519\\ \hline
		0.0 & 1e-08 & -1e-08 & 1e-08 & 0.007843361877348798& 2.616263909306617& 0.011943312516877023\\ \hline
		0.0 & 1e-08 & 0.0 & -1e-08 & 0.004874183597166848& 1.6258526422744108& 0.006348515908213231\\ \hline
		0.0 & 1e-08 & 0.0 & 0.0& 0.003130371630018401& 1.0441795809506624& 0.0031303716300184014\\ \hline
		0.0 & 1e-08 & 0.0 & 1e-08 & 0.0048741847940618754& 1.625853041515618& 0.006818648390008188\\ \hline
		0.0 & 1e-08 & 1e-08 & -1e-08 & 0.007843358973332215& 2.6162629406309525& 0.010430919837948303\\ \hline
		0.0 & 1e-08 & 1e-08 & 0.0& 0.0037651563628227575& 1.2559209761055996& 0.004882935812255012\\ \hline
		0.0 & 1e-08 & 1e-08 & 1e-08 & 0.0019050079081353033& 0.6354422395569456& 0.0024660010804776157\\ \hline
		1e-08 & -1e-08 & -1e-08 & -1e-08 & 0.0038100157316875993& 1.270884450900037& 0.00493200200656702\\ \hline
		1e-08 & -1e-08 & -1e-08 & 0.0& 0.004432329038088232& 1.4784658259885959& 0.005123365006660067\\ \hline
		1e-08 & -1e-08 & -1e-08 & 1e-08 & 0.007530314268212469& 2.51184246675615& 0.009765873307382277\\ \hline
		1e-08 & -1e-08 & 0.0 & -1e-08 & 0.0067791910105370334& 2.2612947167954776& 0.008791032103324697\\ \hline
		1e-08 & -1e-08 & 0.0 & 0.0& 0.004547052681636891& 1.5167335143668823& 0.004974923371334387\\ \hline
		1e-08 & -1e-08 & 0.0 & 1e-08 & 0.004052679547793384& 1.3518283871992989& 0.00627826616226323\\ \hline
		1e-08 & -1e-08 & 1e-08 & -1e-08 & 0.00974836608111218& 3.251704913218094& 0.01363729119340706\\ \hline
		1e-08 & -1e-08 & 1e-08 & 0.0& 0.006755114955525785& 2.253263809285482& 0.008887448941220831\\ \hline
		1e-08 & -1e-08 & 1e-08 & 1e-08 & 0.006260742089685394& 2.088358771514116& 0.006260742089685398\\ \hline
		1e-08 & 0.0 & -1e-08 & -1e-08 & 0.0038100156862128642& 1.270884435731298& 0.0040478277262057044\\ \hline
		1e-08 & 0.0 & -1e-08 & 0.0& 0.004432329039101824& 1.4784658263266939& 0.004626475842468455\\ \hline
		1e-08 & 0.0 & -1e-08 & 1e-08 & 0.007530314269216668& 2.5118424670911144& 0.009675889448788031\\ \hline
		1e-08 & 0.0 & 0.0 & -1e-08 & 0.006779190892302722& 2.2612946773567564& 0.007451067177968972\\ \hline
		1e-08 & 0.0 & 0.0 & 0.0& 0.0019050078853979358& 0.6354422319725762& 0.0024660010333099705\\ \hline
		1e-08 & 0.0 & 0.0 & 1e-08 & 0.0037651568773816096& 1.2559211477439576& 0.004882936374572602\\ \hline
		1e-08 & 0.0 & 1e-08 & -1e-08 & 0.009748365891937283& 3.2517048501161403& 0.012263268873330244\\ \hline
		1e-08 & 0.0 & 1e-08 & 0.0& 0.004874183626270678& 1.6258526519824037& 0.0068186465317888086\\ \hline
		1e-08 & 0.0 & 1e-08 & 1e-08 & 0.003130371242934457& 1.044179451833357& 0.0031303712429344576\\ \hline
		1e-08 & 1e-08 & -1e-08 & -1e-08 & 0.0038100157498774934& 1.2708844569675324& 0.005295623212204739\\ \hline
		1e-08 & 1e-08 & -1e-08 & 0.0& 0.004432329034983857& 1.4784658249530878& 0.006013163994621043\\ \hline
		1e-08 & 1e-08 & -1e-08 & 1e-08 & 0.007530314264603885& 2.511842465552456& 0.010558022872095875\\ \hline
		1e-08 & 1e-08 & 0.0 & -1e-08 & 0.0067791908822982805& 2.261294674019634& 0.007304314014517098\\ \hline
		1e-08 & 1e-08 & 0.0 & 0.0& 0.0019050078899454093& 0.6354422334894501& 0.0026478116411153716\\ \hline
		1e-08 & 1e-08 & 0.0 & 1e-08 & 0.0037651568749766462& 1.2559211469417482& 0.005279011129162013\\ \hline
		1e-08 & 1e-08 & 1e-08 & -1e-08 & 0.009748365803716297& 3.251704820688787& 0.011593026100057103\\ \hline
		1e-08 & 1e-08 & 1e-08 & 0.0& 0.004874183558058576& 1.6258526292292954& 0.00579651388500594\\ \hline
		1e-08 & 1e-08 & 1e-08 & 1e-08 & 2.7284841053187847e-12& 9.101243323322492e-10& 3.775546784232932e-12\\ \hline
	\end{longtable}
\end{center}

The largest error found is $13.63$m when $\Delta(t_1, t_2, t_3, t_4) = (-1, +1, -1, +1)10^{-8}$ and the maximum EMF is $3.25$ which is the condition number of the problem.

\section{}

In this case we execute the same as in part 4, but this time we put the satellites closer together. specifically we choose $\phi_i \in [0.96, 0.98, 1, 1.02]$ and $\theta_i \in [1.5, 1.54, 1.58, 1.62]$.
With these data the multivariate newton continues to calculate the position accurately enough, even though it requires many more iterations, 36 in this run, compared to 1 in the previous execution.
\begin{center}
	\begin{tabular}{r | c}
		& True data\\ \hline
		x & 6.5027567179123906e-08\\ \hline
		y & 2.8280480572376489e-08\\ \hline
		z & 6370.0000001376047\\ \hline
	\end{tabular}
\end{center}

When we change the timings by one nanosecond though, the emf is much larger as is the error in distance calculation:

\begin{center}
	\begin{longtable}{@{}c|@{}c|@{}c|@{}c|@{}c|@{}c|@{}cX@{}}
		$\Delta t_1$ & $\Delta t_2$ & $\Delta t_3$ & $\Delta t_4$ & $\| \Delta x, \Delta y, \Delta z \|_{\inf}$ & EMF & distance\\ \hline
        -1e-08 & -1e-08 & -1e-08 & -1e-08 & 6.359641702147201e-08 & 2.1213481312777508e-05 & 7.159775717224163e-08\\ \hline
        -1e-08 & -1e-08 & -1e-08 & 0.0 & 60.5379638173963 & 20193.291136517124 & 68.18514401374526\\ \hline
        -1e-08 & -1e-08 & -1e-08 & 1e-08 & 121.3544030755902 & 40479.4716815277 & 136.68897690410617\\ \hline
        -1e-08 & -1e-08 & 0.0 &-1e-08 & 179.12557400796777 & 59749.86005226708 & 201.63981734480356\\ \hline
        -1e-08 & -1e-08 & 0.0 &0.0 & 119.40449266769065 & 39829.05158025687 & 134.3917736333589\\ \hline
        -1e-08 & -1e-08 & 0.0 &1e-08 & 59.412825917083865 & 19817.985530628714 & 66.83920459010058\\ \hline
        -1e-08 & -1e-08 & 1e-08 & -1e-08 & 355.8545639920385 & 118700.30572261583 & 400.538628827746\\ \hline
        -1e-08 & -1e-08 & 1e-08 & 0.0 & 296.9273530919236 & 99044.30392582226 & 334.1984202034798\\ \hline
        -1e-08 & -1e-08 & 1e-08 & 1e-08 & 237.73717987465625 & 79300.58734159038 & 267.55821700853716\\ \hline
        -1e-08 & 0.0 &-1e-08 & -1e-08 & 180.99137949268788 & 60372.22577092108 & 203.66742689519253\\ \hline
        -1e-08 & 0.0 &-1e-08 & 0.0 & 242.3682600808279 & 80845.34942116519 & 272.8066672531845\\ \hline
        -1e-08 & 0.0 &-1e-08 & 1e-08 & 304.03175169576934 & 101414.07621928843 & 342.27589087131014\\ \hline
        -1e-08 & 0.0 &0.0 &-1e-08 & 1.0815457589413577 & 360.76483268656335 & 1.6262482475828357\\ \hline
        -1e-08 & 0.0 &0.0 &0.0 & 59.94122005105055 & 19994.238841926093 & 67.39746941189864\\ \hline
        -1e-08 & 0.0 &0.0 &1e-08 & 120.75594002729031 & 40279.84589620694 & 135.89135322703575\\ \hline
        -1e-08 & 0.0 &1e-08 & -1e-08 & 179.71572809822737 & 59946.714267515636 & 202.42798295382389\\ \hline
        -1e-08 & 0.0 &1e-08 & 0.0 & 119.9962385904746 & 40026.43677368139 & 135.179695733832\\ \hline
        -1e-08 & 0.0 &1e-08 & 1e-08 & 60.00619533639201 & 20015.912264202667 & 67.62176229696242\\ \hline
        -1e-08 & 1e-08 & -1e-08 & -1e-08 & 364.5096928434814 & 121587.34594829041 & 410.2215039384516\\ \hline
        -1e-08 & 1e-08 & -1e-08 & 0.0 & 426.74995229406704 & 142348.46178775097 & 480.3470044561403\\ \hline
        -1e-08 & 1e-08 & -1e-08 & 1e-08 & 489.2852480820957 & 163207.9911562131 & 550.8115070319824\\ \hline
        -1e-08 & 1e-08 & 0.0 &-1e-08 & 180.3910733831126 & 60171.98520653328 & 202.88502640911045\\ \hline
        -1e-08 & 1e-08 & 0.0 &0.0 & 241.76616872146224 & 80644.51336154604 & 272.01539293195475\\ \hline
        -1e-08 & 1e-08 & 0.0 &1e-08 & 303.42784156829475 & 101212.63348393035 & 341.4782624620383\\ \hline
        -1e-08 & 1e-08 & 1e-08 & -1e-08 & 2.163117212736596 & 721.5382362538172 & 3.2525605198572034\\ \hline
        -1e-08 & 1e-08 & 1e-08 & 0.0 & 59.34441515528306 & 19795.1661567548 & 66.6403194716029\\ \hline
        -1e-08 & 1e-08 & 1e-08 & 1e-08 & 120.15741556563717 & 40080.199625596564 & 135.10873525439888\\ \hline
        0.0 &-1e-08 & -1e-08 & -1e-08 & 59.66882298276414 & 19903.37696026068 & 67.08660332282744\\ \hline
        0.0 &-1e-08 & -1e-08 & 0.0 & 1.0815198748668124 & 360.7561986886531 & 1.62618479896542\\ \hline
        0.0 &-1e-08 & -1e-08 & 1e-08 & 61.134645965808886 & 20392.32287757802 & 69.00229294343366\\ \hline
        0.0 &-1e-08 & 0.0 &-1e-08 & 237.99012459240294 & 79384.9606175451 & 267.8026408551849\\ \hline
        0.0 &-1e-08 & 0.0 &0.0 & 178.5354835324888 & 59553.02705662529 & 200.86159321936904\\ \hline
        0.0 &-1e-08 & 0.0 &1e-08 & 118.81280951867666 & 39631.68732590814 & 133.61886299281508\\ \hline
        0.0 &-1e-08 & 1e-08 & -1e-08 & 413.9373192299563 & 138074.6274303654 & 465.8074993254508\\ \hline
        0.0 &-1e-08 & 1e-08 & 0.0 & 355.2691019974236 & 118505.01662200641 & 399.7645293673873\\ \hline
        0.0 &-1e-08 & 1e-08 & 1e-08 & 296.340389705133 & 98848.51401468996 & 333.42465741680337\\ \hline
        0.0 &0.0 &-1e-08 & -1e-08 & 120.49683431565427 & 40193.4175338989 & 135.64047693680266\\ \hline
        0.0 &0.0 &-1e-08 & 0.0 & 181.59162520627524 & 60572.446189375805 & 204.45990946904863\\ \hline
        0.0 &0.0 &-1e-08 & 1e-08 & 242.97029134263357 & 81046.1654343961 & 273.60546059258274\\ \hline
        0.0 &0.0 &0.0 &-1e-08 & 60.26216265516541 & 20101.293771334553 & 67.86950190574123\\ \hline
        0.0 &0.0 &0.0 &1e-08 & 60.53796364246682 & 20193.29107816693 & 68.18514381680546\\ \hline
        0.0 &0.0 &1e-08 & -1e-08 & 238.5786539314122 & 79581.27287411262 & 268.58238190335555\\ \hline
        0.0 &0.0 &1e-08 & 0.0 & 179.1255740079814 & 59749.86005227164 & 201.6398173447764\\ \hline
        0.0 &0.0 &1e-08 & 1e-08 & 119.40449260094374 & 39829.0515579925 & 134.391773558261\\ \hline
        0.0 &1e-08 & -1e-08 & -1e-08 & 303.1655401598655 & 101125.13915191237 & 341.2240889694212\\ \hline
        0.0 &1e-08 & -1e-08 & 0.0 & 365.1154839636183 & 121789.41611526432 & 411.01913713100697\\ \hline
        0.0 &1e-08 & -1e-08 & 1e-08 & 427.3576308141728 & 142551.16152358812 & 481.14981932898746\\ \hline
        0.0 &1e-08 & 0.0 &-1e-08 & 119.89834047601926 & 39993.7814776943 & 134.8581002383105\\ \hline
        0.0 &1e-08 & 0.0 &0.0 & 180.99137934011287 & 60372.22572002754 & 203.66742672342136\\ \hline
        0.0 &1e-08 & 0.0 &1e-08 & 242.36826019468936 & 80845.34945914528 & 272.80666738149637\\ \hline
        0.0 &1e-08 & 1e-08 & -1e-08 & 60.85556488035127 & 20299.231447771428 & 68.68185643347574\\ \hline
        0.0 &1e-08 & 1e-08 & 0.0 & 1.0815456885264938 & 360.764809198693 & 1.6262484386814968\\ \hline
        0.0 &1e-08 & 1e-08 & 1e-08 & 59.94122007060196 & 19994.23884844774 & 67.39746943385731\\ \hline
        1e-08 & -1e-08 & -1e-08 & -1e-08 & 119.06779848329006 & 39716.742489219694 & 133.86523806313454\\ \hline
        1e-08 & -1e-08 & -1e-08 & 0.0 & 59.07554609356248 & 19705.48109140799 & 66.33419917747348\\ \hline
        1e-08 & -1e-08 & -1e-08 & 1e-08 & 2.1630140503633917 & 721.5038249901227 & 3.2523057014663297\\ \hline
        1e-08 & -1e-08 & 0.0 &-1e-08 & 296.5923537700055 & 98932.56018005585 & 333.66802973234604\\ \hline
        1e-08 & -1e-08 & 0.0 &0.0 & 237.40165957403133 & 79188.6698160329 & 267.0303950220416\\ \hline
        1e-08 & -1e-08 & 0.0 &1e-08 & 177.94545649091378 & 59356.21522025629 & 200.09342478282406\\ \hline
        1e-08 & -1e-08 & 1e-08 & -1e-08 & 471.76502710387285 & 157363.87449486443 & 530.786638155399\\ \hline
        1e-08 & -1e-08 & 1e-08 & 0.0 & 413.3533934906891 & 137879.8507693813 & 465.03802398242897\\ \hline
        1e-08 & -1e-08 & 1e-08 & 1e-08 & 354.68370488014625 & 118309.7491621474 & 398.9954267525754\\ \hline
        1e-08 & 0.0 &-1e-08 & -1e-08 & 60.27989553124462 & 20107.20882210229 & 67.93520217649963\\ \hline
        1e-08 & 0.0 &-1e-08 & 0.0 & 121.09526735173768 & 40393.03330822181 & 136.43788986839465\\ \hline
        1e-08 & 0.0 &-1e-08 & 1e-08 & 182.19181089512585 & 60772.64658573352 & 205.2623562938845\\ \hline
        1e-08 & 0.0 &0.0 &-1e-08 & 119.65945176607329 & 39914.09678126618 & 134.63831493308896\\ \hline
        1e-08 & 0.0 &0.0 &0.0 & 59.66882301385613 & 19903.376970631853 & 67.0866033578276\\ \hline
        1e-08 & 0.0 &0.0 &1e-08 & 1.0815199111905967 & 360.7562108049633 & 1.626184696249907\\ \hline
        1e-08 & 0.0 &1e-08 & -1e-08 & 297.17928777330326 & 99128.34028990995 & 334.44183137845266\\ \hline
        1e-08 & 0.0 &1e-08 & 0.0 & 237.9901246300742 & 79384.96063011089 & 267.802640897554\\ \hline
        1e-08 & 0.0 &1e-08 & 1e-08 & 178.5354835341177 & 59553.027057168634 & 200.8615932212098\\ \hline
        1e-08 & 1e-08 & -1e-08 & -1e-08 & 242.10702517725804 & 80758.21083687586 & 272.5535766009547\\ \hline
        1e-08 & 1e-08 & -1e-08 & 0.0 & 303.76941949680077 & 101326.57161665207 & 342.0216038641937\\ \hline
        1e-08 & 1e-08 & -1e-08 & 1e-08 & 365.72121646221876 & 121991.46672819844 & 411.8217920609483\\ \hline
        1e-08 & 1e-08 & 0.0 &-1e-08 & 59.68318193656978 & 19908.166591697372 & 67.14794281525351\\ \hline
        1e-08 & 1e-08 & 0.0 &0.0 & 120.49683451333385 & 40193.41759983771 & 135.64047715930164\\ \hline
        1e-08 & 1e-08 & 0.0 &1e-08 & 181.59162538852888 & 60572.44625016908 & 204.4599096742393\\ \hline
        1e-08 & 1e-08 & 1e-08 & -1e-08 & 120.25116803235778 & 40111.47208234728 & 135.42637373355836\\ \hline
        1e-08 & 1e-08 & 1e-08 & 0.0 & 60.2621627411836 & 20101.293800027135 & 67.86950200252186\\ \hline
        1e-08 & 1e-08 & 1e-08 & 1e-08 & 3.5428456612862647e-08 & 1.1817661080556811e-05 & 3.9892872154059495e-08\\ \hline
	\end{longtable}
\end{center}

Here the maximum emf is $163,207$ and the distance error is more than $550$km when $\Delta(t_1, t_2, t_3, t_4) = (-1, +1, -1, +1)10^{-8}$. The condition number, being the same as the maximum emf, is much worse than in the case of randomly distributed satellites.

\end{document}
